from subprocess import check_output
import sys
import time

for i in range(500):
	padd = "A"*i
	open("pad","w").write(padd)
	try:
		res = check_output(["/bin/bash","-c","./start < pad"])
		sys.stdout.write(f"\r\r[+] Trying {i} Bytes.")
		sys.stdout.flush()
	except:
		print(f"\n[*] Offset Found : {i} - {i-1}")
		break
	if(b"Segmentation fault" in res):
		print(f"\n[+] Offset Found : {i} - {i-1}")
		break
	time.sleep(0.01)
